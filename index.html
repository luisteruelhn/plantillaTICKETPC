<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>TICKET TALLER TYT SYSTEMS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://luisteruelhn.github.io/plantillaTICKETPC/style.css">
</head>

<body>
  <div class="ticket">
    <header>
      <img id="_qr" alt="QR del equipo" class="qr-header">
      <br> 
      <img src="https://luisteruelhn.github.io/plantillaTICKETPC/TYTLOGO.png" alt="TYT SYSTEMS" class="logo-full">
    </header>
    
    <section class="datos">
      <p><strong>Fecha:</strong> <span id="FECHA_RECEPCION"></span></p>
      <p><strong>ID Taller::</strong> <span id="IDxORDENPC"></span></p>
      <hr>
     <div class="cliente-bloque">
      <div class="cliente-labels">
        <span><strong>Cliente:</strong></span>
        
      </div>
      <div class="cliente-datos">
        <span id="NOMBRECLIENTE"></span>
        <span><strong>Tel:</strong></span>
        <span id="TELCLIENTE"></span>
      </div>
    </div>

      
      <p><strong>Dirección:</strong> <span id="DIRCLIENTE"></span></p>
      <p><em>Recibido por:</em> <span id="RECIBIDO_POR"></span></p>
     
    </section>

    <section>
      <h3>DETALLE DEL EQUIPO</h3>
      <p id="pwInfo" style="display:none;"><strong>PW:</strong> <span id="CLAVE"></span> (<span id="GARANTIA"></span>)</p>
      <p><strong>Equipo:</strong> <span id="EQUIPOX"></span></p>
      <p><strong>Marca:</strong> <span id="MARCA"></span></p>
      <hr>
      <p><strong>Información adicional:</strong> <span id="INFO2"></span></p>
      <p><strong>Extra:</strong> <span id="INFO1"></span></p>
      <hr>
    </section>

    <section>
      <h3>SERVICIO REQUERIDO</h3>
      <p><span id="SERVICIOREQUERIDO"></span></p>
      <h3>TRABAJO REALIZADO</h3>
      <p><span id="SERVICIOREALIZADO"></span></p>
      <hr>
      <p><strong>Estado:</strong> <span id="ESTADO"></span></p>
      <p><strong>Costo LPS:</strong> <span id="COSTOLPS"></span></p>
      <hr>
    </section>

<section id="seccionConforme">
  <p><strong>Conforme:</strong></p>
  <img id="CONFORME_IMG" alt="Firma de conformidad" class="firma" style="display:none;">
  <p id="TEXTOCONFORME"></p>
</section>



    <section class="whatsapp">
    <img src="https://luisteruelhn.github.io/plantillaTICKETPC/TYTWHA.png" alt="QR WhatsApp" class="qr-full">
    </section>

  
  </div>

<script>
  const params = new URLSearchParams(window.location.search);
  const campos = [
    "FECHA_RECEPCION","IDTALLERPC","IDxORDENPC",
    "NOMBRECLIENTE","TELCLIENTE","DIRCLIENTE",
    "RECIBIDO_POR","EQUIPOX","MARCA","INFO1","INFO2",
    "SERVICIOREQUERIDO","SERVICIOREALIZADO",
    "ESTADO","COSTOLPS","CONFORME","TEXTOCONFORME","_qr",
      "CLAVE","GARANTIA"
  ];

  campos.forEach(c => {
    const valor = params.get(c);
    if (valor) {
      const el = document.getElementById(c);
      if (el) {
        if (c === "_qr") {
          el.src = decodeURIComponent(valor);   // Carga el QR dinámico
          el.alt = "QR del equipo";
          el.style.display = "block";
        } else {
          el.textContent = decodeURIComponent(valor);
        }
      }
    }
  });

  // --- Mostrar la firma (CONFORME) solo si existe ---
  const firmaParam = params.get("CONFORME");
  const imgFirma = document.getElementById("CONFORME_IMG");
  if (imgFirma) {
    if (firmaParam && firmaParam.trim() !== "") {
      let firmaURL = decodeURIComponent(firmaParam);

      // Si la URL es una ruta interna de AppSheet, convertirla en una URL pública
      if (firmaURL.startsWith("PC_Images/")) {
        firmaURL =
          "https://www.appsheet.com/template/gettablefileurl?" +
          "appName=TYTOneDBA-909404411" +
          "&tableName=PC" +
          "&fileName=" + encodeURIComponent(firmaURL);
      }

      imgFirma.src = firmaURL;
      imgFirma.style.display = "block";
    } else {
      imgFirma.style.display = "none";
    }
  }

  // --- Control de modo de impresión ---
const modo = params.get("modo");

if (modo === "corto") {
  // Oculta secciones que no deben verse en el ticket corto
  const ocultar = [
    "SERVICIOREALIZADO", // texto largo del trabajo
    "CONFORME_IMG",
    "TEXTOCONFORME",
    "seccionConforme",
    "qr-full",            // QR de WhatsApp
  ];

  ocultar.forEach(id => {
    const el = document.getElementById(id);
    if (el) el.style.display = "none";
  });

  // También puedes ocultar el pie de página si existe
  const pie = document.querySelector(".whatsapp");
  if (pie) pie.style.display = "none";
}
// Mostrar PW y Garantía en modo corto
const pwInfo = document.getElementById("pwInfo");
if (pwInfo) pwInfo.style.display = "block";

</script>


</body>
</html>
